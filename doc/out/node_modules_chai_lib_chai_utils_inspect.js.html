<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: node_modules/chai/lib/chai/utils/inspect.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: node_modules/chai/lib/chai/utils/inspect.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>// This is (almost) directly from Node.js utils
// https://github.com/joyent/node/blob/f8c335d0caf47f16d31413f89aa28eda3878e3aa/lib/util.js

var getName = require('./getName');
var getProperties = require('./getProperties');
var getEnumerableProperties = require('./getEnumerableProperties');

module.exports = inspect;

/**
 * Echos the value of a value. Trys to print the value out
 * in the best way possible given the different types.
 *
 * @param {Object} obj The object to print out.
 * @param {Boolean} showHidden Flag that shows hidden (not enumerable)
 *    properties of objects.
 * @param {Number} depth Depth in which to descend in object. Default is 2.
 * @param {Boolean} colors Flag to turn on ANSI escape codes to color the
 *    output. Default is false (no coloring).
 */
function inspect(obj, showHidden, depth, colors) {
  var ctx = {
    showHidden: showHidden,
    seen: [],
    stylize: function (str) { return str; }
  };
  return formatValue(ctx, obj, (typeof depth === 'undefined' ? 2 : depth));
}

// https://gist.github.com/1044128/
var getOuterHTML = function(element) {
  if ('outerHTML' in element) return element.outerHTML;
  var ns = "http://www.w3.org/1999/xhtml";
  var container = document.createElementNS(ns, '_');
  var elemProto = (window.HTMLElement || window.Element).prototype;
  var xmlSerializer = new XMLSerializer();
  var html;
  if (document.xmlVersion) {
    return xmlSerializer.serializeToString(element);
  } else {
    container.appendChild(element.cloneNode(false));
    html = container.innerHTML.replace('>&lt;', '>' + element.innerHTML + '&lt;');
    container.innerHTML = '';
    return html;
  }
};

// Returns true if object is a DOM element.
var isDOMElement = function (object) {
  if (typeof HTMLElement === 'object') {
    return object instanceof HTMLElement;
  } else {
    return object &amp;&amp;
      typeof object === 'object' &amp;&amp;
      object.nodeType === 1 &amp;&amp;
      typeof object.nodeName === 'string';
  }
};

function formatValue(ctx, value, recurseTimes) {
  // Provide a hook for user-specified inspect functions.
  // Check that value is an object with an inspect function on it
  if (value &amp;&amp; typeof value.inspect === 'function' &amp;&amp;
      // Filter out the util module, it's inspect function is special
      value.inspect !== exports.inspect &amp;&amp;
      // Also filter out any prototype objects using the circular check.
      !(value.constructor &amp;&amp; value.constructor.prototype === value)) {
    var ret = value.inspect(recurseTimes);
    if (typeof ret !== 'string') {
      ret = formatValue(ctx, ret, recurseTimes);
    }
    return ret;
  }

  // Primitive types cannot have properties
  var primitive = formatPrimitive(ctx, value);
  if (primitive) {
    return primitive;
  }

  // If it's DOM elem, get outer HTML.
  if (isDOMElement(value)) {
    return getOuterHTML(value);
  }

  // Look up the keys of the object.
  var visibleKeys = getEnumerableProperties(value);
  var keys = ctx.showHidden ? getProperties(value) : visibleKeys;

  // Some type of object without properties can be shortcutted.
  // In IE, errors have a single `stack` property, or if they are vanilla `Error`,
  // a `stack` plus `description` property; ignore those for consistency.
  if (keys.length === 0 || (isError(value) &amp;&amp; (
      (keys.length === 1 &amp;&amp; keys[0] === 'stack') ||
      (keys.length === 2 &amp;&amp; keys[0] === 'description' &amp;&amp; keys[1] === 'stack')
     ))) {
    if (typeof value === 'function') {
      var name = getName(value);
      var nameSuffix = name ? ': ' + name : '';
      return ctx.stylize('[Function' + nameSuffix + ']', 'special');
    }
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    }
    if (isDate(value)) {
      return ctx.stylize(Date.prototype.toUTCString.call(value), 'date');
    }
    if (isError(value)) {
      return formatError(value);
    }
  }

  var base = '', array = false, braces = ['{', '}'];

  // Make Array say that they are Array
  if (isArray(value)) {
    array = true;
    braces = ['[', ']'];
  }

  // Make functions say that they are functions
  if (typeof value === 'function') {
    var name = getName(value);
    var nameSuffix = name ? ': ' + name : '';
    base = ' [Function' + nameSuffix + ']';
  }

  // Make RegExps say that they are RegExps
  if (isRegExp(value)) {
    base = ' ' + RegExp.prototype.toString.call(value);
  }

  // Make dates with properties first say the date
  if (isDate(value)) {
    base = ' ' + Date.prototype.toUTCString.call(value);
  }

  // Make error with message first say the error
  if (isError(value)) {
    return formatError(value);
  }

  if (keys.length === 0 &amp;&amp; (!array || value.length == 0)) {
    return braces[0] + base + braces[1];
  }

  if (recurseTimes &lt; 0) {
    if (isRegExp(value)) {
      return ctx.stylize(RegExp.prototype.toString.call(value), 'regexp');
    } else {
      return ctx.stylize('[Object]', 'special');
    }
  }

  ctx.seen.push(value);

  var output;
  if (array) {
    output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);
  } else {
    output = keys.map(function(key) {
      return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);
    });
  }

  ctx.seen.pop();

  return reduceToSingleString(output, base, braces);
}


function formatPrimitive(ctx, value) {
  switch (typeof value) {
    case 'undefined':
      return ctx.stylize('undefined', 'undefined');

    case 'string':
      var simple = '\'' + JSON.stringify(value).replace(/^"|"$/g, '')
                                               .replace(/'/g, "\\'")
                                               .replace(/\\"/g, '"') + '\'';
      return ctx.stylize(simple, 'string');

    case 'number':
      return ctx.stylize('' + value, 'number');

    case 'boolean':
      return ctx.stylize('' + value, 'boolean');
  }
  // For some reason typeof null is "object", so special case here.
  if (value === null) {
    return ctx.stylize('null', 'null');
  }
}


function formatError(value) {
  return '[' + Error.prototype.toString.call(value) + ']';
}


function formatArray(ctx, value, recurseTimes, visibleKeys, keys) {
  var output = [];
  for (var i = 0, l = value.length; i &lt; l; ++i) {
    if (Object.prototype.hasOwnProperty.call(value, String(i))) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          String(i), true));
    } else {
      output.push('');
    }
  }
  keys.forEach(function(key) {
    if (!key.match(/^\d+$/)) {
      output.push(formatProperty(ctx, value, recurseTimes, visibleKeys,
          key, true));
    }
  });
  return output;
}


function formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {
  var name, str;
  if (value.__lookupGetter__) {
    if (value.__lookupGetter__(key)) {
      if (value.__lookupSetter__(key)) {
        str = ctx.stylize('[Getter/Setter]', 'special');
      } else {
        str = ctx.stylize('[Getter]', 'special');
      }
    } else {
      if (value.__lookupSetter__(key)) {
        str = ctx.stylize('[Setter]', 'special');
      }
    }
  }
  if (visibleKeys.indexOf(key) &lt; 0) {
    name = '[' + key + ']';
  }
  if (!str) {
    if (ctx.seen.indexOf(value[key]) &lt; 0) {
      if (recurseTimes === null) {
        str = formatValue(ctx, value[key], null);
      } else {
        str = formatValue(ctx, value[key], recurseTimes - 1);
      }
      if (str.indexOf('\n') > -1) {
        if (array) {
          str = str.split('\n').map(function(line) {
            return '  ' + line;
          }).join('\n').substr(2);
        } else {
          str = '\n' + str.split('\n').map(function(line) {
            return '   ' + line;
          }).join('\n');
        }
      }
    } else {
      str = ctx.stylize('[Circular]', 'special');
    }
  }
  if (typeof name === 'undefined') {
    if (array &amp;&amp; key.match(/^\d+$/)) {
      return str;
    }
    name = JSON.stringify('' + key);
    if (name.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)) {
      name = name.substr(1, name.length - 2);
      name = ctx.stylize(name, 'name');
    } else {
      name = name.replace(/'/g, "\\'")
                 .replace(/\\"/g, '"')
                 .replace(/(^"|"$)/g, "'");
      name = ctx.stylize(name, 'string');
    }
  }

  return name + ': ' + str;
}


function reduceToSingleString(output, base, braces) {
  var numLinesEst = 0;
  var length = output.reduce(function(prev, cur) {
    numLinesEst++;
    if (cur.indexOf('\n') >= 0) numLinesEst++;
    return prev + cur.length + 1;
  }, 0);

  if (length > 60) {
    return braces[0] +
           (base === '' ? '' : base + '\n ') +
           ' ' +
           output.join(',\n  ') +
           ' ' +
           braces[1];
  }

  return braces[0] + base + ' ' + output.join(', ') + ' ' + braces[1];
}

function isArray(ar) {
  return Array.isArray(ar) ||
         (typeof ar === 'object' &amp;&amp; objectToString(ar) === '[object Array]');
}

function isRegExp(re) {
  return typeof re === 'object' &amp;&amp; objectToString(re) === '[object RegExp]';
}

function isDate(d) {
  return typeof d === 'object' &amp;&amp; objectToString(d) === '[object Date]';
}

function isError(e) {
  return typeof e === 'object' &amp;&amp; objectToString(e) === '[object Error]';
}

function objectToString(o) {
  return Object.prototype.toString.call(o);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Classes</h3><ul><li><a href="server.html">server</a></li></ul><h3>Global</h3><ul><li><a href="global.html"></a></li><li><a href="global.html#__express">__express</a></li><li><a href="global.html#a">a</a></li><li><a href="global.html#above">above</a></li><li><a href="global.html#addChainableMethod">addChainableMethod</a></li><li><a href="global.html#addMethod">addMethod</a></li><li><a href="global.html#addProperty">addProperty</a></li><li><a href="global.html#arguments">arguments</a></li><li><a href="global.html#assert">assert</a></li><li><a href="global.html#Attrs">Attrs</a></li><li><a href="global.html#attrs">attrs</a></li><li><a href="global.html#awesome">awesome</a></li><li><a href="global.html#Base">Base</a></li><li><a href="global.html#below">below</a></li><li><a href="global.html#Block">Block</a></li><li><a href="global.html#BlockComment">BlockComment</a></li><li><a href="global.html#cache">cache</a></li><li><a href="global.html#camelcase">camelcase</a></li><li><a href="global.html#Case">Case</a></li><li><a href="global.html#cdata">cdata</a></li><li><a href="global.html#clean">clean</a></li><li><a href="global.html#closeTo">closeTo</a></li><li><a href="global.html#Code">Code</a></li><li><a href="global.html#color">color</a></li><li><a href="global.html#colorLines">colorLines</a></li><li><a href="global.html#colors">colors</a></li><li><a href="global.html#Command">Command</a></li><li><a href="global.html#Comment">Comment</a></li><li><a href="global.html#compile">compile</a></li><li><a href="global.html#Compiler">Compiler</a></li><li><a href="global.html#Context">Context</a></li><li><a href="global.html#coverage">coverage</a></li><li><a href="global.html#coverageClass">coverageClass</a></li><li><a href="global.html#create">create</a></li><li><a href="global.html#cursor">cursor</a></li><li><a href="global.html#Date">Date</a></li><li><a href="global.html#deep">deep</a></li><li><a href="global.html#deepEqual">deepEqual</a></li><li><a href="global.html#deepProperty">deepProperty</a></li><li><a href="global.html#deepPropertyNotVal">deepPropertyNotVal</a></li><li><a href="global.html#deepPropertyVal">deepPropertyVal</a></li><li><a href="global.html#Doc">Doc</a></li><li><a href="global.html#Doctype">Doctype</a></li><li><a href="global.html#doctypes">doctypes</a></li><li><a href="global.html#doesNotThrow">doesNotThrow</a></li><li><a href="global.html#Dot">Dot</a></li><li><a href="global.html#Each">Each</a></li><li><a href="global.html#empty">empty</a></li><li><a href="global.html#eql">eql</a></li><li><a href="global.html#equal">equal</a></li><li><a href="global.html#error">error</a></li><li><a href="global.html#errorDiff">errorDiff</a></li><li><a href="global.html#escape">escape</a></li><li><a href="global.html#escapeRegexp">escapeRegexp</a></li><li><a href="global.html#EventEmitter">EventEmitter</a></li><li><a href="global.html#exec">exec</a></li><li><a href="global.html#exist">exist</a></li><li><a href="global.html#fail">fail</a></li><li><a href="global.html#false">false</a></li><li><a href="global.html#files">files</a></li><li><a href="global.html#Filter">Filter</a></li><li><a href="global.html#filter">filter</a></li><li><a href="global.html#filterLeaks">filterLeaks</a></li><li><a href="global.html#filters">filters</a></li><li><a href="global.html#flag">flag</a></li><li><a href="global.html#forEach">forEach</a></li><li><a href="global.html#format">format</a></li><li><a href="global.html#fragment">fragment</a></li><li><a href="global.html#fs">fs</a></li><li><a href="global.html#getAllFlags">getAllFlags</a></li><li><a href="global.html#getEnumerableProperties">getEnumerableProperties</a></li><li><a href="global.html#getMessage">getMessage</a></li><li><a href="global.html#getPathValue">getPathValue</a></li><li><a href="global.html#getProperties">getProperties</a></li><li><a href="global.html#getType">getType</a></li><li><a href="global.html#globals">globals</a></li><li><a href="global.html#growl">growl</a></li><li><a href="global.html#hideSuitesWithout">hideSuitesWithout</a></li><li><a href="global.html#highlight">highlight</a></li><li><a href="global.html#highlightTags">highlightTags</a></li><li><a href="global.html#Hook">Hook</a></li><li><a href="global.html#HTML">HTML</a></li><li><a href="global.html#HTMLCov">HTMLCov</a></li><li><a href="global.html#ignore">ignore</a></li><li><a href="global.html#ignored">ignored</a></li><li><a href="global.html#image">image</a></li><li><a href="global.html#include">include</a></li><li><a href="global.html#includeMembers">includeMembers</a></li><li><a href="global.html#indexOf">indexOf</a></li><li><a href="global.html#inspect">inspect</a></li><li><a href="global.html#instanceOf">instanceOf</a></li><li><a href="global.html#instanceof">instanceof</a></li><li><a href="global.html#interpolate">interpolate</a></li><li><a href="global.html#isArray">isArray</a></li><li><a href="global.html#isatty">isatty</a></li><li><a href="global.html#isBoolean">isBoolean</a></li><li><a href="global.html#isConstant">isConstant</a></li><li><a href="global.html#isDefined">isDefined</a></li><li><a href="global.html#isFalse">isFalse</a></li><li><a href="global.html#isFunction">isFunction</a></li><li><a href="global.html#isNotArray">isNotArray</a></li><li><a href="global.html#isNotBoolean">isNotBoolean</a></li><li><a href="global.html#isNotFunction">isNotFunction</a></li><li><a href="global.html#isNotNull">isNotNull</a></li><li><a href="global.html#isNotNumber">isNotNumber</a></li><li><a href="global.html#isNotObject">isNotObject</a></li><li><a href="global.html#isNotString">isNotString</a></li><li><a href="global.html#isNull">isNull</a></li><li><a href="global.html#isNumber">isNumber</a></li><li><a href="global.html#isObject">isObject</a></li><li><a href="global.html#isString">isString</a></li><li><a href="global.html#isTrue">isTrue</a></li><li><a href="global.html#isUndefined">isUndefined</a></li><li><a href="global.html#itself">itself</a></li><li><a href="global.html#JSONCov">JSONCov</a></li><li><a href="global.html#JSONReporter">JSONReporter</a></li><li><a href="global.html#keys">keys</a></li><li><a href="global.html#Landing">Landing</a></li><li><a href="global.html#language%2520chains">language chains</a></li><li><a href="global.html#least">least</a></li><li><a href="global.html#length">length</a></li><li><a href="global.html#lengthOf">lengthOf</a></li><li><a href="global.html#Lexer">Lexer</a></li><li><a href="global.html#Library">Library</a></li><li><a href="global.html#list">list</a></li><li><a href="global.html#List">List</a></li><li><a href="global.html#Literal">Literal</a></li><li><a href="global.html#map">map</a></li><li><a href="global.html#Markdown">Markdown</a></li><li><a href="global.html#match">match</a></li><li><a href="global.html#members">members</a></li><li><a href="global.html#merge">merge</a></li><li><a href="global.html#Min">Min</a></li><li><a href="global.html#Mixin">Mixin</a></li><li><a href="global.html#Mocha">Mocha</a></li><li><a href="global.html#most">most</a></li><li><a href="global.html#Node">Node</a></li><li><a href="global.html#nodes">nodes</a></li><li><a href="global.html#not">not</a></li><li><a href="global.html#notDeepEqual">notDeepEqual</a></li><li><a href="global.html#notDeepProperty">notDeepProperty</a></li><li><a href="global.html#notEqual">notEqual</a></li><li><a href="global.html#notInclude">notInclude</a></li><li><a href="global.html#notInstanceOf">notInstanceOf</a></li><li><a href="global.html#notMatch">notMatch</a></li><li><a href="global.html#notOk">notOk</a></li><li><a href="global.html#notProperty">notProperty</a></li><li><a href="global.html#notStrictEqual">notStrictEqual</a></li><li><a href="global.html#notTypeOf">notTypeOf</a></li><li><a href="global.html#null">null</a></li><li><a href="global.html#nulls">nulls</a></li><li><a href="global.html#NyanCat">NyanCat</a></li><li><a href="global.html#objDisplay">objDisplay</a></li><li><a href="global.html#ok">ok</a></li><li><a href="global.html#on">on</a></li><li><a href="global.html#operator">operator</a></li><li><a href="global.html#Option">Option</a></li><li><a href="global.html#outputHelpIfNecessary">outputHelpIfNecessary</a></li><li><a href="global.html#overwriteMethod">overwriteMethod</a></li><li><a href="global.html#overwriteProperty">overwriteProperty</a></li><li><a href="global.html#ownProperty">ownProperty</a></li><li><a href="global.html#pad">pad</a></li><li><a href="global.html#parse">parse</a></li><li><a href="global.html#parseBool">parseBool</a></li><li><a href="global.html#parseQuery">parseQuery</a></li><li><a href="global.html#Parser">Parser</a></li><li><a href="global.html#path">path</a></li><li><a href="global.html#Progress">Progress</a></li><li><a href="global.html#property">property</a></li><li><a href="global.html#propertyNotVal">propertyNotVal</a></li><li><a href="global.html#propertyVal">propertyVal</a></li><li><a href="global.html#reduce">reduce</a></li><li><a href="global.html#render">render</a></li><li><a href="global.html#renderFile">renderFile</a></li><li><a href="global.html#respondTo">respondTo</a></li><li><a href="global.html#rethrow">rethrow</a></li><li><a href="global.html#Runnable">Runnable</a></li><li><a href="global.html#Runner">Runner</a></li><li><a href="global.html#runtime">runtime</a></li><li><a href="global.html#s">s</a></li><li><a href="global.html#sameMembers">sameMembers</a></li><li><a href="global.html#satisfy">satisfy</a></li><li><a href="global.html#selfClosing">selfClosing</a></li><li><a href="global.html#slug">slug</a></li><li><a href="global.html#Spec">Spec</a></li><li><a href="global.html#statsTemplate">statsTemplate</a></li><li><a href="global.html#strictEqual">strictEqual</a></li><li><a href="global.html#string">string</a></li><li><a href="global.html#Suite">Suite</a></li><li><a href="global.html#symbols">symbols</a></li><li><a href="global.html#tag">tag</a></li><li><a href="global.html#Tag">Tag</a></li><li><a href="global.html#TAP">TAP</a></li><li><a href="global.html#Teamcity">Teamcity</a></li><li><a href="global.html#test">test</a></li><li><a href="global.html#Test">Test</a></li><li><a href="global.html#text">text</a></li><li><a href="global.html#Text">Text</a></li><li><a href="global.html#textOnly">textOnly</a></li><li><a href="global.html#throw">throw</a></li><li><a href="global.html#throws">throws</a></li><li><a href="global.html#title">title</a></li><li><a href="global.html#toString">toString</a></li><li><a href="global.html#trim">trim</a></li><li><a href="global.html#true">true</a></li><li><a href="global.html#tty">tty</a></li><li><a href="global.html#type">type</a></li><li><a href="global.html#typeOf">typeOf</a></li><li><a href="global.html#undefined">undefined</a></li><li><a href="global.html#unhide">unhide</a></li><li><a href="global.html#use">use</a></li><li><a href="global.html#useColors">useColors</a></li><li><a href="global.html#utils">utils</a></li><li><a href="global.html#version">version</a></li><li><a href="global.html#watch">watch</a></li><li><a href="global.html#window">window</a></li><li><a href="global.html#within">within</a></li><li><a href="global.html#write">write</a></li><li><a href="global.html#XUnit">XUnit</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha10</a> on Wed Oct 29 2014 12:23:10 GMT+0100 (CET)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
