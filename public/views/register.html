<md-content layout="column">
    <form role="form" name="form" ng-submit="createUser()" layout="column">
        <div layout="row">
            <md-input-container>
                <label>First Name</label>
                <input type="text" name="firstName" ng-model="userForm.firstName" required>
                <div ng-messages="form.firstName.$error">
                    <div ng-message="required">This field is required.</div>
                </div>
            </md-input-container>
            <md-input-container>
                <label>Last Name</label>
                <input type="text" name="lastName" ng-model="userForm.lastName" required>
                <div ng-messages="form.lastName.$error">
                    <div ng-message="required">This field is required.</div>
                </div>
            </md-input-container>
        </div>
        <div class="form-group">
            <label for="personId" class="col-xs-1 control-label">Person in database {{ personId }}</label>
            <md-radio-group ng-model="userForm.personId" ng-if="persons.length > 0">
                <md-radio-button  ng-repeat="person in persons" ng-value="person.id" aria-label="{{ person.firstName + ' ' + person.lastName }}"><personmin person="person" />
                </md-radio-button>
            </md-radio-group>
            <label class="control-label" ng-show="persons.length == 0">
                Your name will be added to the database.
            </label>
        </div>
        <div ng-hide="userForm.personId">
            <label>Profile image</label><br />
            <img ng-src="{{userForm.profileImageSrc || '/assets/dummy.jpg'}}" class="profile-image" ng-model="userForm.profileImageSrc" name="profileImage" alt="profile image" />
            <md-input-container>
                <input type="file" accept="image/*" onchange="angular.element(this).scope().fileNameChanged(this)" />
            </md-input-container>
        </div>
        <md-input-container>
            <label>Email</label>
            <input type="email" name="email" ng-model="userForm.email" required>
            <div ng-messages="form.email.$error">
                <div ng-message="required">This field is required.</div>
                <div ng-message="email">Please enter a valid email address.</div>
            </div>
        </md-input-container>
        <md-input-container>
            <label>Password</label>
            <input type="password" ng-minlength="8" name="password" ng-model="userForm.password" required>
            <div ng-messages="form.password.$error">
                <div ng-message="required">This field is required.</div>
                <div ng-message="minlength">The password needs to be at least 8 characters long.</div>
            </div>
        </md-input-container>
        <div class="form-block">
            <h4>Person Affiliation</h4>
            <ul>
                <li ng-repeat="chosenAffiliation in affiliations">
                    <p>{{chosenAffiliation.name}}</p>
                </li>
            </ul>
            <md-button 
                class="md-raised" 
                ng-show="affiliations.length > 0" 
                ng-click="popAffiliation()">Undo</md-button>
            <md-autocomplete
                md-selected-item="selectedAffiliation"
                md-search-text="affiliationName"
                md-items="affiliation in filterAffiliations(affiliationName)"
                md-item-text="affiliation.name"
                md-no-cache="true"
                placeholder="University, Faculty, Department ...">
                <span md-highlight-text="affiliationName">{{affiliation.name}}</span>
            </md-autocomplete>
            <md-button 
                class="md-raised" 
                ng-show="affiliationName != selectedAffiliation.name && affiliationName.length > 0" 
                ng-click="postAffiliation(affiliationName)">Add affiliation</md-button>
        </div>
        <md-button type="submit" class="md-raised md-primary" ng-disabled="form.$invalid">Register</md-button>
    </form>
</md-content>
